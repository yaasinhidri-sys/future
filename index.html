<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>YASSIN OMNI-SYSTEM | PRO VERSION</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        :root { --neon: #00f2fe; --bg: #020205; --key-bg: #11111d; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        .sidebar { width: 300px; background: #08080c; border-left: 1px solid #1a1a2e; padding: 20px; display: flex; flex-direction: column; gap: 15px; }
        #camera-container { width: 100%; border-radius: 12px; border: 2px solid #222; overflow: hidden; position: relative; background: #000; height: 200px; }
        #webcam { width: 100%; height: 100%; object-fit: cover; transform: scaleX(-1); display: none; }
        .cam-placeholder { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #444; }
        
        .btn-control { background: #1a1a35; color: var(--neon); border: 1px solid var(--neon); padding: 10px; border-radius: 8px; cursor: pointer; transition: 0.3s; }
        .btn-control.active { background: var(--neon); color: #000; box-shadow: 0 0 15px var(--neon); }

        #chat-flow { flex: 1; overflow-y: auto; padding: 25px; display: flex; flex-direction: column; gap: 15px; background: radial-gradient(circle, #0d0d25 0%, #020205 100%); }
        .bubble { max-width: 85%; padding: 18px; border-radius: 20px; animation: slideIn 0.3s; line-height: 1.7; }
        .ai { background: rgba(0, 242, 254, 0.05); border: 1px solid rgba(0, 242, 254, 0.2); align-self: flex-start; }
        .user { background: var(--neon); color: #000; font-weight: bold; align-self: flex-end; }

        .input-hub { background: #000; padding: 15px; display: flex; gap: 10px; border-top: 1px solid #1a1a2e; align-items: center; }
        #masterInput { flex: 1; background: #0c0c15; border: 1px solid #222; color: var(--neon); padding: 15px; border-radius: 30px; outline: none; }
        
        .voice-btn { background: #ff0055; border: none; width: 50px; height: 50px; border-radius: 50%; color: white; cursor: pointer; transition: 0.3s; }
        .voice-btn.recording { animation: pulse 1s infinite; background: #ff0000; box-shadow: 0 0 20px #ff0000; }

        .cyber-keyboard { background: rgba(5, 5, 10, 0.98); display: grid; grid-template-columns: repeat(10, 1fr); gap: 5px; padding: 10px; border-top: 2px solid var(--neon); }
        .key { background: var(--key-bg); border: 1px solid #222; color: white; padding: 12px 2px; text-align: center; border-radius: 5px; cursor: pointer; font-size: 1rem; transition: 0.1s; }
        .key:active { background: var(--neon); color: #000; transform: scale(0.9); }

        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
        @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } }
    </style>
</head>
<body>

    <aside class="sidebar">
        <h3 style="color:var(--neon)"><i class="fas fa-shield-alt"></i> Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©</h3>
        <div id="camera-container">
            <video id="webcam" autoplay muted playsinline></video>
            <div class="cam-placeholder" id="cam-text">Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ù…ØºÙ„Ù‚Ø©</div>
        </div>
        <button id="camToggle" class="btn-control" onclick="toggleCamera()">ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§</button>
        <div class="info-panel" id="voice-status" style="font-size: 0.8rem; color: #888;">Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ†: Ø¬Ø§Ù‡Ø²</div>
    </aside>

    <main style="flex:1; display:flex; flex-direction:column;">
        <div id="chat-flow">
            <div class="bubble ai"><strong>[Ø§Ù„ÙˆØ¹ÙŠ Ø§Ù„Ø´Ø§Ù…Ù„ Ø¬Ø§Ù‡Ø²]</strong><br>ØªÙ… Ø¯Ù…Ø¬ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø§Ù„Ù…ØªØ­ÙƒÙ… Ø¨Ù‡Ø§ ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØµÙˆØªÙŠ. Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ† Ù„Ù„ØªØ­Ø¯Ø« Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù€ Clavier.</div>
        </div>

        <div class="input-hub">
            <button class="voice-btn" id="voiceBtn" onclick="toggleVoice()"><i class="fas fa-microphone"></i></button>
            <input type="text" id="masterInput" placeholder="Ø§ÙƒØªØ¨ Ø£Ùˆ ØªØ­Ø¯Ø«..." readonly>
            <button onclick="executeOmni()" style="background:var(--neon); border:none; width:50px; height:50px; border-radius:50%; cursor:pointer;"><i class="fas fa-paper-plane"></i></button>
        </div>

        <div class="cyber-keyboard" id="clavier">
            <div class="key" onclick="press('Ø£')">Ø£</div><div class="key" onclick="press('Ø¨')">Ø¨</div><div class="key" onclick="press('Øª')">Øª</div><div class="key" onclick="press('Ø«')">Ø«</div><div class="key" onclick="press('Ø¬')">Ø¬</div><div class="key" onclick="press('Ø­')">Ø­</div><div class="key" onclick="press('Ø®')">Ø®</div><div class="key" onclick="press('Ø¯')">Ø¯</div><div class="key" onclick="press('Ø°')">Ø°</div><div class="key" onclick="press('Ø±')">Ø±</div>
            <div class="key" onclick="press('Ø²')">Ø²</div><div class="key" onclick="press('Ø³')">Ø³</div><div class="key" onclick="press('Ø´')">Ø´</div><div class="key" onclick="press('Øµ')">Øµ</div><div class="key" onclick="press('Ø¶')">Ø¶</div><div class="key" onclick="press('Ø·')">Ø·</div><div class="key" onclick="press('Ø¸')">Ø¸</div><div class="key" onclick="press('Ø¹')">Ø¹</div><div class="key" onclick="press('Øº')">Øº</div><div class="key" onclick="press('Ù')">Ù</div>
            <div class="key" style="grid-column: span 2" onclick="del()">Ø­Ø°Ù</div>
            <div class="key" style="grid-column: span 6" onclick="press(' ')">SPACE</div>
            <div class="key" style="grid-column: span 2" onclick="executeOmni()">Ø¥Ø±Ø³Ø§Ù„</div>
        </div>
    </main>

    <script>
        const API_KEY = "AIzaSyCnNPqeYw3Soht8PGKIMpv_IbruwUhQbJs";
        let stream = null;
        const video = document.getElementById('webcam');
        const camBtn = document.getElementById('camToggle');
        const input = document.getElementById('masterInput');

        // ğŸ“· ÙˆØ¸ÙŠÙØ© Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
        async function toggleCamera() {
            if (!stream) {
                try {
                    stream = await navigator.mediaDevices.getUserMedia({ video: true });
                    video.srcObject = stream;
                    video.style.display = "block";
                    document.getElementById('cam-text').style.display = "none";
                    camBtn.innerText = "Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§";
                    camBtn.classList.add('active');
                } catch (e) { alert("ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ÙƒØ§Ù…ÙŠØ±Ø§"); }
            } else {
                stream.getTracks().forEach(track => track.stop());
                stream = null;
                video.style.display = "none";
                document.getElementById('cam-text').style.display = "block";
                camBtn.innerText = "ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§";
                camBtn.classList.remove('active');
            }
        }

        // ğŸ™ï¸ ÙˆØ¸ÙŠÙØ© Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØµÙˆØªÙŠ (Speech to Text)
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        if (SpeechRecognition) {
            const recognition = new SpeechRecognition();
            recognition.lang = 'ar-SA';
            
            recognition.onstart = () => {
                document.getElementById('voiceBtn').classList.add('recording');
                document.getElementById('voice-status').innerText = "Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ†: Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹...";
            };
            
            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                input.value = transcript;
                setTimeout(executeOmni, 500); // Ø¥Ø±Ø³Ø§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ø¯Ø«
            };
            
            recognition.onend = () => {
                document.getElementById('voiceBtn').classList.remove('recording');
                document.getElementById('voice-status').innerText = "Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ†: Ø¬Ø§Ù‡Ø²";
            };

            window.toggleVoice = () => recognition.start();
        } else {
            document.getElementById('voiceBtn').style.display = "none";
        }

        function press(char) { input.value += char; }
        function del() { input.value = input.value.slice(0, -1); }

        async function executeOmni() {
            const val = input.value;
            if(!val) return;
            const chat = document.getElementById('chat-flow');
            chat.innerHTML += `<div class="bubble user">${val}</div>`;
            input.value = "";
            chat.scrollTop = chat.scrollHeight;

            const aiLoading = document.createElement('div');
            aiLoading.className = 'bubble ai';
            aiLoading.innerHTML = `<i class="fas fa-robot"></i> Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...`;
            chat.appendChild(aiLoading);

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent?key=${API_KEY}`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ contents: [{ parts: [{ text: val }] }] })
                });
                const data = await response.json();
                aiLoading.innerHTML = `<strong>[G-PRO]</strong>:<br>${data.candidates[0].content.parts[0].text.replace(/\n/g, '<br>')}`;
            } catch (e) { aiLoading.innerHTML = "ÙØ´Ù„ ÙÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠ."; }
            chat.scrollTop = chat.scrollHeight;
        }
    </script>
</body>
</html>
